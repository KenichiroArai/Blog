# CodeSignal記録システム作成指示書

## 目的

CodeSignalでの学習記録を自動的に管理・表示するシステムを構築する。

## データソース

`CodeSignalの記録.xlsm`ファイルから以下のデータを読み込む：

- 番号
- 記録日
- days
- パス名
- パスURL
- Course番号
- Course名
- CourseURL
- 進捗率
- ユニット番号
- 成功数
- 実践数

## 作成するファイル

この指示書の直下に作成し、既にファイルがある場合は上書きをしてください。

1. `CodeSignalの記録.html`
   - 学習記録を表示するWebページ
   - レスポンシブデザイン
   - モダンなUI/UX

2. `CodeSignalの記録.js`
   - 記録データの管理と表示ロジック
   - HTMLファイルとの連携
   - 固定Excelファイルの読み込み機能

## 具体的な要件

### HTMLファイル要件

- ヘッダー部分に「CodeSignal学習記録」というタイトル
- 最新の学習記録詳細セクション
  - 最新のデータを大きく表示
  - Course名とパス名を強調表示
  - 進捗率をプログレスバーで表示
  - URLはカード形式で表示
  - 学習日数と成功率の視覚的表示
- 記録一覧を表示するメインセクション
  - テーブル形式でデータを表示
  - 各列のソート機能
  - URLはクリック可能なリンクとして表示
- レスポンシブなグリッドレイアウト
- モダンで見やすいデザイン
- Bootstrap 5を使用

### JavaScriptファイル要件

- HTMLとの連携機能
  - 記録の表示
  - イベントハンドリング
  - 動的なUI更新
- Excelファイル処理機能
  - SheetJS (XLSX) ライブラリを使用
  - 固定パス`CodeSignalの記録.xlsm`からのデータ読み込み
  - データの解析と表示
  - エラーハンドリング
- データ処理機能
  - 最新データの抽出と詳細表示
  - 進捗率に基づく色分け表示
  - 日付順のソート
  - 検索・フィルタリング機能
- 統計処理機能
  - 成功率の計算
  - 学習日数の集計

## デザイン指針

- カラースキーム：青を基調とした配色
- フォント：見やすさを重視
- レイアウト：
  - 最新データを上部に目立つように配置
  - シンプルで使いやすい配置
- データ表示：
  - 最新データはカード形式
  - 一覧は整理された表形式
  - 進捗率による行の色分け
  - クリック可能なリンク

## 必要なライブラリ

- Bootstrap 5：UIフレームワーク
- SheetJS：Excelファイル処理
- DataTables：テーブル機能強化

## 注意事項

- コードの可読性を重視
- コメントを適切に付与
- エラーハンドリングを実装
- 定期的なデータ更新の仕組み
- パフォーマンスの最適化

### Excelファイル(.xlsm)読み込みに関する注意点

1. マクロ対応ファイルの制限
   - SheetJSではマクロ部分（VBAコード）は読み込めない
   - データ部分のみが読み込み可能

2. セキュリティ対策
   - Same-Origin Policyの制限に注意
   - ローカルファイルへの直接アクセスは制限あり
   - 適切なファイルアクセス方法の実装が必要

3. データ型の処理
   - 日付データは適切な型に変換
   - 数値データの文字列解釈に注意
   - 型変換処理の実装が必要

4. エラーハンドリング実装
   - ファイル不存在の場合の処理
   - ファイル破損時の処理
   - アクセス権限エラーの処理
   - ユーザーへのエラー表示

5. パフォーマンス対策
   - 大容量ファイル読み込みへの対応
   - 非同期処理の実装
   - ローディング表示の実装

## チェックリスト

### 環境セットアップ

- [ ] 必要なライブラリのインストール
  - [ ] Bootstrap 5
  - [ ] SheetJS
  - [ ] DataTables
- [ ] プロジェクトフォルダの作成
- [ ] 初期ファイルの作成
  - [ ] CodeSignalの記録.html
  - [ ] CodeSignalの記録.js

### HTMLファイル作成

- [ ] ヘッダーセクションの実装
- [ ] 最新の学習記録セクションの実装
  - [ ] カード形式のレイアウト
  - [ ] プログレスバーの実装
  - [ ] 統計情報の表示
- [ ] 記録一覧セクションの実装
  - [ ] テーブルの基本構造
  - [ ] ソート機能の実装
  - [ ] レスポンシブデザインの適用
- [ ] スタイリングの適用
  - [ ] Bootstrap 5の適用
  - [ ] カスタムCSSの追加

### JavaScriptファイル作成

- [ ] Excelファイル処理機能の実装
  - [ ] SheetJSの初期設定
  - [ ] ファイル読み込み機能
  - [ ] データ解析処理
  - [ ] データ型変換処理の実装
  - [ ] エラーハンドリングの実装
  - [ ] 非同期処理の実装
  - [ ] ローディング表示機能
- [ ] データ表示機能の実装
  - [ ] 最新データの表示
  - [ ] テーブルデータの表示
  - [ ] 動的更新機能
- [ ] イベントハンドリングの実装
  - [ ] ソート機能
  - [ ] フィルター機能
- [ ] 統計処理機能の実装
  - [ ] 成功率計算
  - [ ] 学習日数集計

### テストと最適化

- [ ] 機能テスト
  - [ ] データ読み込みテスト
  - [ ] 表示機能テスト
  - [ ] イベント処理テスト
- [ ] パフォーマンス最適化
  - [ ] コード最適化
  - [ ] 読み込み速度の改善
- [ ] クロスブラウザテスト
- [ ] エラーハンドリングの確認

### ドキュメント作成

- [ ] コードコメントの追加
- [ ] README.mdの作成
- [ ] 使用方法の文書化
