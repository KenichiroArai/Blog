<h2>開発記録</h2>
<h3>前回からの進捗</h3>
<p>
    kmg-toolのテストの実装を進めてはいるが、パッケージ構成が気になったので、大幅に変更した。今までの構成は、kmg-toolプロジェクトに対して、application、domain、infrastructure、presentationの4つのパッケージで分けていたが、クラスが増え分かりにくくなったので下記のように機能ごとにパッケージを分けるようにした。
</p>
<p>
    <a href="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_001.png" target="_blank">
        <img src="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_001.png" alt="00163_001.png" width="400" height="400" border="0">
    </a>
</p>
<p>
    また、それに伴いメッセージのIDルールも変更した。下記の画像の通り、メッセージ、ログ、バリデーションの3つ変更している。
</p>
<p>
    <a href="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_002.png" target="_blank">
        <img src="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_002.png" alt="00163_002.png" width="400" height="400" border="0">
    </a>
</p>
<p>
    メッセージの変更のソースへの対応は、マッピング変換ツールを作成し、新旧でマッピングを行うようにした。
</p>
<p>
    <a href="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_003.png" target="_blank">
        <img src="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_003.png" alt="00163_003.png" width="400" height="400" border="0">
    </a>
</p>
<p>
    下記の画像の通り、1行目は対応するフォルダのパス、2行目以降は、「対象値,置換値」を指定する。
</p>
<p>
    <a href="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_004.png" target="_blank">
        <img src="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_004.png" alt="00163_004.png" width="400" height="400" border="0">
    </a>
</p>
<p>
    ロジック下記の画像の通り、まず、対象のファイルをすべて読み込み、対象値をUUIDに置き換える。その後、再度、対象のファイルをすべて読み込み、置換値をUUIDに置き換える。このようなロジックで行えば、対象値と置換値の組み合わせが複雑だったとしても問題なく置換できる。
</p>
<p>
    <a href="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_005.png" target="_blank">
        <img src="https://blog-imgs-163.fc2.com/a/r/a/araikenichiro/00163_005.png" alt="00163_005.png" width="400" height="400" border="0">
    </a>
</p>
<p>
    この置換ロジックのテクニックは下記でも紹介した内容でもある。
</p>
<p>
    <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">一意はUUIDなどを使えば楽である。データは、<br>・変更前<br>・UUID<br>・変更後<br>をExcelやCSVなどで持っていれば、どんな変換にも対応できる。<br>ただ、一度、UUIDにすべて変換するため、無駄な処理をしているが、ここが割り切りポイントで特に一時的なツールであれば問題ないことが殆どのはずだ。</p>&mdash; 新井健一朗@want to (@arai_kenichiro) <a href="https://twitter.com/arai_kenichiro/status/1894673013804773632?ref_src=twsrc%5Etfw">February 26, 2025</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</p>
<h3>テストの進捗</h3>
<p>
    kmg-toolのテスト実装は変わらず、未実行命令は、9,364件のまま。
</p>
<h2>リンク</h2>
<ol>
    <li>
        前回の記事：<a href="https://araikenichiro.blog.fc2.com/blog-entry-148.html"
            target="_blank">kmg-toolのv0.1.0に向けて#009</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/Blog/tree/main/araikenichiro.blog.fc2.com/%E7%95%AA%E5%8F%B7%E3%81%94%E3%81%A8/00101/00163"
            target="_blank">本記事のGitHubでの管理</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-core" title="kmg-core" target="_blank">kmg-coreのGitHubリポジトリ</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-core/tree/features/0.2.0" title="kmg-coreの現在の作業用ブランチ"
            target="_blank">kmg-coreの現在の作業用ブランチ</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-fund" title="kmg-fund" target="_blank">kmg-fundのGitHubリポジトリ</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-fund/tree/features/0.1.0" title="kmg-fundの現在の作業用ブランチ"
            target="_blank">kmg-fundの現在の作業用ブランチ</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-tool" title="kmg-tool" target="_blank">kmg-toolのGitHubリポジトリ</a>
    </li>
    <li>
        <a href="https://github.com/KenichiroArai/kmg-tool/tree/features/0.1.0" title="kmg-toolの現在の作業用ブランチ"
            target="_blank">kmg-toolの現在の作業用ブランチ</a>
    </li>
</ol>
