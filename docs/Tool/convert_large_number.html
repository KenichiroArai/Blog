<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>日本の大きな数変換ツール</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-hover: #45a049;
            --background-color: #f5f5f5;
            --text-color: #333;
            --border-radius: 8px;
            --box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            padding: 20px;
            margin: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            box-sizing: border-box;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 30px;
        }

        .container {
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            box-sizing: border-box;
        }

        @media (min-width: 800px) {
            .container {
                padding: 60px;
            }

            body {
                padding: 40px;
            }

            h1 {
                font-size: 2.5em;
                margin-bottom: 50px;
            }

            input[type="number"],
            input[type="text"] {
                padding: 15px;
                font-size: 1.2em;
            }

            button {
                padding: 15px 30px;
                font-size: 1.2em;
            }

            .result-container {
                padding: 25px;
                margin-top: 35px;
            }

            #result {
                font-size: 1.5em;
            }

            .progress-container {
                margin-top: 30px;
                padding: 15px;
            }

            .progress-bar {
                height: 25px;
            }

            .progress-labels {
                font-size: 1em;
                min-height: 50px;
            }
        }

        @media (min-width: 1600px) {
            .container {
                max-width: 1600px;
                padding: 80px;
            }

            body {
                padding: 60px;
            }
        }

        input[type="number"],
        input[type="text"] {
            width: 100%;
            padding: 12px;
            font-size: 1.1em;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus,
        input[type="text"]:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1.1em;
            cursor: pointer;
            border-radius: var(--border-radius);
            transition: background-color 0.3s;
            width: 100%;
        }

        button:hover {
            background-color: var(--primary-hover);
        }

        .conversion-type {
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .conversion-type label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .unit-input {
            display: none;
        }

        .result-container {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 25px;
            padding: 15px;
            background-color: #f8f8f8;
            border-radius: var(--border-radius);
        }

        #result {
            font-size: 1.3em;
            font-weight: 500;
            flex-grow: 1;
        }

        .copy-button {
            background-color: var(--primary-color);
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .copy-success {
            color: var(--primary-color);
            font-size: 0.9em;
            display: none;
            animation: fadeIn 0.3s;
        }

        .back-link {
            margin-top: 30px;
            text-align: center;
        }

        .back-link a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .back-link a:hover {
            text-decoration: underline;
        }

        .progress-container {
            margin-top: 20px;
            display: none;
            overflow-x: auto;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
        }

        .progress-bar {
            min-width: 1200px;
            max-width: 95%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            overflow: hidden;
            margin: 0;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        .progress-labels {
            position: relative;
            min-width: 1200px;
            max-width: 95%;
            margin: 0;
            margin-top: 5px;
            font-size: 0.8em;
            color: #666;
            min-height: 40px;
            white-space: nowrap;
        }

        .progress-label {
            position: absolute;
            transform: translateX(-50%);
            white-space: nowrap;
            text-align: center;
            padding: 0 10px;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @media (max-width: 600px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }

            .conversion-type {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .progress-container {
                padding: 5px;
            }

            input[type="number"],
            input[type="text"] {
                font-size: 16px;
                /* iOSでのズームを防ぐ */
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>数の単位変換ツール</h1>

        <div class="conversion-type">
            <label>
                <input type="radio" id="numberToUnit" name="conversionType" value="numberToUnit" checked>
                数値から単位へ
            </label>
            <label>
                <input type="radio" id="unitToNumber" name="conversionType" value="unitToNumber">
                単位から数値へ
            </label>
        </div>

        <div id="numberInputGroup" class="input-group">
            <input type="number" id="numberInput" placeholder="数値を入力してください">
        </div>

        <div id="unitInputGroup" class="input-group unit-input">
            <input type="text" id="unitInput" placeholder="例：1億2000万">
        </div>

        <button onclick="convert()">変換</button>
        <div class="result-container">
            <div id="result"></div>
        </div>
        <div class="progress-container" id="progressContainer">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-labels" id="progressLabels"></div>
        </div>
        <div>
            <button id="copyButton" class="copy-button" onclick="copyResult()" style="display: none;">コピー</button>
            <span id="copySuccess" class="copy-success">コピーしました！</span>
        </div>
    </div>
    <div class="back-link">
        <a href="../">← トップページに戻る</a>
    </div>

    <script>
        const units = [
            "", "万", "億", "兆", "京", "垓", "𥝱", "穣", "溝", "澗", "正", "載",
            "極", "恒河沙", "阿僧祇", "那由他", "不可思議", "無量大数"
        ];
        const UNIT_SEPARATOR = '-';
        let selectedUnitsIdx = 0;

        function formatJapaneseNumber(numberStr) {

            let result = '';

            const numberWk = numberStr.toString().replace(/\B(?=(\d{4})+(?!\d))/g, UNIT_SEPARATOR);
            selectedUnitsIdx = Math.floor(numberStr.length / 4);

            let unitsIdx = selectedUnitsIdx;
            for (let i = 0; i < numberWk.length; i++) {
                if (numberWk[i] === UNIT_SEPARATOR) {
                    result += units[unitsIdx];
                    unitsIdx--;
                    continue;
                }
                result += numberWk[i];
            }

            return result;
        }

        function parseJapaneseNumber(str) {
            let result = 0;
            let currentNumber = 0;
            let currentUnit = "";

            for (let i = 0; i < str.length; i++) {
                const char = str[i];
                if (char >= '0' && char <= '9') {
                    currentNumber = currentNumber * 10 + parseInt(char);
                } else {
                    const unitIndex = units.indexOf(char);
                    if (unitIndex !== -1) {
                        const unitValue = Math.pow(10, unitIndex * 4);
                        result += currentNumber * unitValue;
                        currentNumber = 0;
                    }
                }
            }

            if (currentNumber > 0) {
                result += currentNumber;
            }

            return result;
        }

        function convert() {
            const conversionType = document.querySelector('input[name="conversionType"]:checked').value;
            const resultElement = document.getElementById('result');
            const copyButton = document.getElementById('copyButton');
            const progressContainer = document.getElementById('progressContainer');
            const progressFill = document.getElementById('progressFill');
            const progressLabels = document.getElementById('progressLabels');

            // 進捗バーをクリア
            progressFill.style.width = '0%';
            progressLabels.innerHTML = '';

            if (conversionType === 'numberToUnit') {
                const input = document.getElementById('numberInput').value;
                const result = formatJapaneseNumber(input);
                resultElement.textContent = `変換結果：${result}`;

                // 進捗バーを表示
                progressContainer.style.display = 'block';

                // 進捗バーのラベルを設定
                const progressStep = 100 / (units.length - 1);
                const progressPercentage = progressStep * selectedUnitsIdx;
                progressFill.style.width = `${progressPercentage}%`;

                // ラベルを追加
                const labelContainer = document.createElement('div');
                labelContainer.style.position = 'relative';
                labelContainer.style.width = '100%';
                labelContainer.style.height = '40px';
                labelContainer.style.marginTop = '15px';

                units.forEach((unit, index) => {
                    const label = document.createElement('span');
                    const unitView = unit || '0';
                    label.textContent = unitView;
                    label.className = 'progress-label';
                    const position = (index / (units.length - 1)) * 100;
                    label.style.left = `${position}%`;
                    // 左端のラベルを調整
                    if (index === 0) {
                        label.style.transform = 'translateX(0)';
                    } else {
                        label.style.transform = 'translateX(-50%)';
                    }
                    labelContainer.appendChild(label);
                });

                progressLabels.appendChild(labelContainer);
            } else {
                const input = document.getElementById('unitInput').value;
                const result = parseJapaneseNumber(input);
                resultElement.textContent = `変換結果：${result}`;

                // 進捗バーを非表示
                progressContainer.style.display = 'none';
            }

            copyButton.style.display = 'inline-block';
        }

        function copyResult() {
            const resultText = document.getElementById('result').textContent.replace('変換結果：', '');
            navigator.clipboard.writeText(resultText).then(() => {
                const copySuccess = document.getElementById('copySuccess');
                copySuccess.style.display = 'inline';
                setTimeout(() => {
                    copySuccess.style.display = 'none';
                }, 2000);
            });
        }

        // ラジオボタンの切り替え処理
        document.querySelectorAll('input[name="conversionType"]').forEach(radio => {
            radio.addEventListener('change', function () {
                const numberInputGroup = document.getElementById('numberInputGroup');
                const unitInputGroup = document.getElementById('unitInputGroup');

                if (this.value === 'numberToUnit') {
                    numberInputGroup.style.display = 'block';
                    unitInputGroup.style.display = 'none';
                } else {
                    numberInputGroup.style.display = 'none';
                    unitInputGroup.style.display = 'block';
                }
            });
        });

        // エンターキーで変換を実行
        document.getElementById('numberInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                convert();
            }
        });

        document.getElementById('unitInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                convert();
            }
        });
    </script>
</body>

</html>
